# Schnorr签名算法

## 一. Schnorr签名算法 

Schnorr签名算法是一种基于离散对数问题的数字签名算法，由德国密码学家克劳斯·施诺尔（Claus-Peter Schnorr）于1989年提出。Schnorr签名算法以其签名生成和验证的高效性和简洁性著称，是许多现代密码系统的重要组成部分。以下是Schnorr签名算法的基本工作原理和过程：


### 1.算法参数
- 选择一个大素数 𝑝：确保 𝑝 足够大以保证安全性。
- 选择一个素数 𝑞，𝑞 是 𝑝−1 的一个因子，通常 𝑞 较小。
- 选择一个生成元 𝑔, 𝑔 是 $\mathbf{Z_p}^*$ 整数模 𝑝 的乘法群）的生成元,满足 $g^q \equiv 1 \pmod p$

### 2.密钥生成
- 私钥 𝑥 选择一个随机的私钥 𝑥 满足 0<𝑥<𝑞
- 公钥 y, 计算公钥 $y \equiv g^x \pmod p$

### 3. 签名生成
- 选择一个随机数 𝑘, 𝑘 满足 0 < k < q
- 计算 r，$r \equiv g^k \pmod p$
- 计算哈希值 𝑒, 将消息 𝑚 和 𝑟 结合，计算哈希值 𝑒=𝐻(𝑚,𝑟), 其中 𝐻 是一个安全的哈希函数
- 计算签名 𝑠, $s \equiv (k+xe) \pmod p$

生成的签名为 (𝑒, 𝑠)

### 4.签名验证
- 验证 𝑟, 通过公钥 𝑦 和签名 (𝑒,𝑠) 计算 𝑟′,  $𝑟 \equiv g^s.y^-e \pmod p$
- 计算哈希值 𝑒′： 将消息 𝑚 和计算得到的 𝑟′结合，计算哈希值 𝑒′=𝐻(𝑚,𝑟)。
- 验证签名：如果 𝑒′=𝑒 则签名有效；否则签名无效。

### 5.优点
- 高效性：相比于其它签名算法，Schnorr签名在计算上更加高效，特别是在签名生成和验证过程中。
- 短签名：Schnorr签名长度较短，有助于节省带宽和存储空间。
- 安全性：基于离散对数问题的安全性，难以被破解。

Schnorr签名广泛应用于区块链和加密货币领域，如比特币的Taproot升级中使用了基于Schnorr签名的聚合签名技术。此外，许多密码协议和标准也采用了Schnorr签名算法。

总之，Schnorr签名算法以其高效和安全的特点，成为了现代密码学中的一个重要工具，尤其在对资源要求较高的应用场景中具有显著优势。

## 二. 基于有限单群的 Schnorr 签名算法

基于有限单群的 Schnorr 签名算法是一种扩展和改进的 Schnorr 签名方案，其核心思想仍然依赖于离散对数问题，但引入了有限单群（finite simple group）的概念。这种改进可以在某些方面提供额外的安全性和效率。

### 1.什么是有限单群

有限单群是仅有一个非平凡正规子群（即它自身）的群。这些群在代数结构上具有较高的对称性和复杂性，因此在密码学中应用能够增加某些攻击的难度。

### 2.基于有限单群的 Schnorr 签名算法

#### 2.1.算法参数
- 选择有限单群 𝐺：选择一个有限单群 𝐺 及其阶 𝑛
- 选择生成元 𝑔: 选择 𝐺 的一个生成元 𝑔。

#### 2.2.密钥生成
- 私钥 𝑥 选择一个随机的私钥 𝑥 满足 0<𝑥<n
- 公钥 y, 计算公钥 $y = g^x$
  
#### 2.3. 签名生成
- 选择一个随机数 𝑘, 𝑘 满足 0 < k < n
- 计算 r，$r = g^k$
- 计算哈希值 𝑒, 将消息 𝑚 和 𝑟 结合，计算哈希值 𝑒=𝐻(𝑚,𝑟), 其中 𝐻 是一个安全的哈希函数
- 计算签名 𝑠, $s \equiv (k+xe) \pmod n$

生成的签名为 (𝑒, 𝑠)


#### 2.4.签名验证
- 验证 𝑟, 通过公钥 𝑦 和签名 (𝑒,𝑠) 计算 𝑟′,  $𝑟 \equiv g^s.y^-e$
- 计算哈希值 𝑒′： 将消息 𝑚 和计算得到的 𝑟′结合，计算哈希值 𝑒′=𝐻(𝑚,𝑟)。
- 验证签名：如果 𝑒′=𝑒 则签名有效；否则签名无效。

#### 2.5.优点
- 高安全性：由于有限单群的复杂结构，攻击者更难破解基于这些群的签名。
- 高效性：算法保持了Schnorr签名的高效特点。
- 较短的签名长度：签名长度较短，有助于节省带宽和存储空间。

#### 2.6.应用

基于有限单群的 Schnorr 签名算法可以用于需要高安全性和高效性的场合，如加密货币、区块链技术和其他需要数字签名的应用领域。

总的来说，基于有限单群的 Schnorr 签名算法通过引入有限单群的结构，增强了算法的安全性，同时保持了原始 Schnorr 签名的效率和简洁性。



## 二. 基于有限单群的 Schnorr 多重数字签名算法

基于有限单群的 Schnorr 多重数字签名算法是对传统 Schnorr 签名算法的扩展，使其能够支持多个签名者共同生成一个联合签名。这种方法在区块链和其他分布式系统中具有重要应用，特别是在提高效率和减少数据传输量方面。

### 1.多重签名算法的基本思想

多重签名算法允许多个参与者共同生成一个签名，该签名可以由任何一组验证者进行验证。具体来说，基于有限单群的 Schnorr 多重签名算法使用了有限单群的性质，以增强安全性和性能。


### 2.基于有限单群的 Schnorr 多重数字签名算法

#### 2.1.算法参数
- 选择有限单群 𝐺：选择一个有限单群 𝐺 及其阶 𝑛
- 选择生成元 𝑔: 选择 𝐺 的一个生成元 𝑔。

#### 2.2.密钥生成
每个签名者 𝑖(共有 𝑡个签名者）生成自己的密钥对：

- 私钥 $𝑥_i$ 选择一个随机的私钥 $𝑥_i$ 满足 $0 < 𝑥_i < n$
- 公钥 $y_i$, 计算公钥 $y_i = g^x_i$

联合公钥 \( y \) 为各个签名者公钥的乘积：
\[ y = \prod_{i=1}^{t} y_i = g^{\sum_{i=1}^{t} x_i} \]


  
#### 2.3. 签名生成

- 选择随机数 $k_i$：每个签名者 $i$ 随机选择一个 \( k_i \) 满足 $0 < k_i < n$。
- 计算 $r_i$：每个签名者计算 $r_i = g^{k_i}$。
- 广播 $r_i$：各个签名者相互广播 $r_i$。
- 计算 $r$：汇总所有签名者的 $r_i$计算出联合值 $r$：
 
   $$r = \prod_{i=1}^{t} r_i = g^{\sum_{i=1}^{t} k_i}$$
  
- 计算哈希值 e：将消息 m 和联合值 r 结合，计算哈希值 $ e = H(m, r)$。
- 计算部分签名 $s_i$：每个签名者计算部分签名 $s_i = k_i + x_i \cdot e \mod n$。
- 汇总部分签名 $s$：所有签名者将他们的部分签名相加得到联合签名 $s$：
   
   $$s = \sum_{i=1}^{t} s_i \mod n$$

生成的联合签名为 $(e, s)$。


#### 2.4.签名验证
- 验证 r：通过联合公钥 y 和联合签名 (e, s) 计算  r'：
  
   $$r' = g^s \cdot y^{-e}$$
 
- 计算哈希值 e'：将消息  m 和计算得到的 r' 结合，计算哈希值 $e' = H(m, r'）$。
- 验证签名：如果 e' = e，则签名有效；否则签名无效。


#### 2.5.优点
- 提高安全性：基于有限单群的结构增加了破解难度。
- 高效性：联合签名减少了签名长度和通信开销。
- 灵活性：支持多方共同签名，提高了应用场景的灵活性和可扩展性。

#### 2.6.应用

这种多重签名算法在分布式系统、区块链技术和需要多方共同认证的应用中非常有用，例如多重签名钱包、分布式密钥管理和共识协议等。

总的来说，基于有限单群的 Schnorr 多重数字签名算法通过结合有限单群的复杂结构和多重签名机制，提供了强大的安全性和高效性，适用于现代分布式系统和密码学应用。














  


