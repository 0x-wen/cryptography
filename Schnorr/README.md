# Schnorr签名算法

## 一. Schnorr签名算法 

Schnorr签名算法是一种基于离散对数问题的数字签名算法，由德国密码学家克劳斯·施诺尔（Claus-Peter Schnorr）于1989年提出。Schnorr签名算法以其签名生成和验证的高效性和简洁性著称，是许多现代密码系统的重要组成部分。以下是Schnorr签名算法的基本工作原理和过程：


### 1.算法参数
- 选择一个大素数 𝑝：确保 𝑝 足够大以保证安全性。
- 选择一个素数 𝑞，𝑞 是 𝑝−1 的一个因子，通常 𝑞 较小。
- 选择一个生成元 𝑔, 𝑔 是 $\mathbf{Z_p}^*$ 整数模 𝑝 的乘法群）的生成元,满足 $g^q \equiv 1 \pmod p$

### 2.密钥生成
- 私钥 𝑥 选择一个随机的私钥 𝑥 满足 0<𝑥<𝑞
- 公钥 y, 计算公钥 $y \equiv g^x \pmod p$

### 3. 签名生成
- 选择一个随机数 𝑘, 𝑘 满足 0 < k < q
- 计算 r，$r \equiv g^k \pmod p$
- 计算哈希值 𝑒, 将消息 𝑚 和 𝑟 结合，计算哈希值 𝑒=𝐻(𝑚,𝑟), 其中 𝐻 是一个安全的哈希函数
- 计算签名 𝑠, $s \equiv (k+xe) \pmod p$

### 4.签名验证
- 验证 𝑟, 通过公钥 𝑦 和签名 (𝑒,𝑠) 计算 𝑟′,  $𝑟 \equiv g^s.y^e \pmod p$
- 计算哈希值 𝑒′： 将消息 𝑚 和计算得到的 𝑟′结合，计算哈希值 𝑒′=𝐻(𝑚,𝑟)。
- 验证签名：如果 𝑒′=𝑒 则签名有效；否则签名无效。

### 5.优点
- 高效性：相比于其它签名算法，Schnorr签名在计算上更加高效，特别是在签名生成和验证过程中。
- 短签名：Schnorr签名长度较短，有助于节省带宽和存储空间。
- 安全性：基于离散对数问题的安全性，难以被破解。

Schnorr签名广泛应用于区块链和加密货币领域，如比特币的Taproot升级中使用了基于Schnorr签名的聚合签名技术。此外，许多密码协议和标准也采用了Schnorr签名算法。

总之，Schnorr签名算法以其高效和安全的特点，成为了现代密码学中的一个重要工具，尤其在对资源要求较高的应用场景中具有显著优势。

## 二. Schnorr签名扩展算法




